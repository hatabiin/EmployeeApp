@{
    ViewData["Title"] = "新規登録";
}

<d class="container mt-4">
    <h2>新規登録</h2>
    <hr>

    <form method="post" asp-action="Create">
        
        @if (ViewBag.Error != null)
        {
        <div class="alert alert-danger" role="alert">
            @ViewBag.Error
        </div>  
        }

        <div class="card mb-4">
            <div class="card-header">
                <h4>基本情報</h4>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label for="employeeName" class="form-label">氏名</label>
                    <input type="text" 
                           class="form-control" 
                           id="employeeName" 
                           name="employeeName" />
                </div>
                <div class="mb-3">
                    <label for="newPassword" class="form-label">パスワード</label>
                    <input type="password"
                           class="form-control"
                           id="newPassword"
                           name="newPassword" />
                </div>
                <div class="mb-3">
                    <label for="confirmPassword" class="form-label">パスワード（確認）</label>
                    <input type="password"
                           class="form-control"
                           id="confirmPassword"
                           name="confirmPassword" />
                </div>
            </div>
        </div>

        <div class="card mb-4">
            <div class="card-header">
                <h4>所属会社・部署・課</h4>
            </div>
            <div class="card-body">
                @foreach (var company in ViewBag.AllCompanies)
                {
                    <div class="mb-4">
                        <div class="form-check mb-2">
                            <input class="form-check-input" 
                                type="radio" 
                                name="companyId" 
                                value="@company.Id" 
                                id="company_@company.Id" />
                            <label class="form-check-label fw-bold" for="company_@company.Id">
                                @company.CompanyName
                            </label>
                        </div>
                        
                        <div class="ms-3">
                            @foreach (var dept in company.Departments)
                            {
                                <div class="mb-3">
                                    <div class="form-check mb-2">
                                        <input class="form-check-input" 
                                            type="checkbox" 
                                            name="departmentIds" 
                                            value="@dept.Id" 
                                            id="dept_@dept.Id" />
                                        <label class="form-check-label fw-bold" for="dept_@dept.Id">
                                            @dept.DepartmentName
                                        </label>
                                    </div>
                                    
                                    <div class="ms-3 d-flex flex-wrap">
                                        @foreach (var division in company.Divisions)
                                        {
                                            @if (division.DepartmentId == dept.Id)
                                            {
                                                <div class="me-3 mb-2">
                                                    <div class="form-check">
                                                        <input class="form-check-input" 
                                                            type="checkbox" 
                                                            name="divisionIds" 
                                                            value="@division.Id" 
                                                            id="div_@division.Id" />
                                                        <label class="form-check-label" for="div_@division.Id">
                                                            @division.DivisionName
                                                        </label>
                                                    </div>
                                                </div>
                                            }
                                        }
                                    </div>
                                </div>
                            }
                        </div>
                    </div>
                }
            </div>
        </div>

        <div class="card mb-4">
            <div class="card-header">
                <h4>保有資格</h4>
            </div>
            <div class="card-body">
                <div class="row">
                    @foreach (var license in ViewBag.AllLicenses)
                    {
                        <div class="col-md-6 col-lg-4 mb-2">
                            <div class="form-check">
                                <input class="form-check-input" 
                                       type="checkbox" 
                                       name="licenseIds" 
                                       value="@license.Id" 
                                       id="license_@license.Id" />
                                <label class="form-check-label" for="license_@license.Id">
                                    @license.LicenseName
                                </label>
                            </div>
                        </div>
                    }			
                </div>
            </div>
        </div>

        <!-- ボタン -->
        <div class="mb-4">
            <button type="submit" class="btn btn-primary">
                <i class="fas fa-save me-2"></i>保存
            </button>
            <button type="button" onclick="history.back()" class="btn btn-secondary">キャンセル</button>
            <a asp-action="Index" class="btn btn-outline-secondary">
                <i class="fas fa-list me-2"></i>一覧に戻る
            </a>
        </div>
    </form>
</div>